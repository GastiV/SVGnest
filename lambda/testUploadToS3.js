const fs = require('fs');
const path = require('path');
const AWS = require('aws-sdk');
const {randomUUID} = require('crypto'); //Crypto is part of Node.js runtime since v14.17

const config = {
    accessKeyId: process.env.AWS_S3_ACCESS_KEY_ID || "dummy",
    secretAccessKey: process.env.AWS_S3_ACCESS_KEY_SECRET || "dummy",
    region: process.env.AWS_S3_BUCKET_REGION || "us-east-2",
    bucketName: process.env.AWS_S3_BUCKET_NAME || "servicio-de-tizada",
    nestingServiceHost: process.env.NESTING_SERVICE_HOST || "dummy",
}

// Configure AWS SDK
AWS.config.update({
    accessKeyId: config.accessKeyId,
    secretAccessKey: config.secretAccessKey,
    region: config.region,
});

// Create S3 service object
const s3 = new AWS.S3({apiVersion: "2006-03-01"});

// Create the parameters for calling listObjects
const bucketName = config.bucketName;
let bucketParams = {
    Bucket: bucketName,
};

s3.listBuckets((err, data) => {
    if (err) {
        console.log("Error", err);
    } else {
        console.log("Success", data.Buckets);
    }
});

// Call S3 to obtain a list of the objects in the bucket
s3.listObjects(bucketParams, function (err, data) {
    if (err) {
        console.log("Error", err);
    } else {
        console.log("Success", data);
    }
});

const uploadSVGToS3 = (filePath, bucketName, keyPrefix = '') => {
    const fileName = path.basename(filePath);
    const fileContent = fs.readFileSync(filePath);

    const params = {
        Bucket: bucketName,
        Key: keyPrefix + fileName,
        Body: fileContent,
        ContentType: 'image/svg+xml'
    };

    return s3.upload(params).promise();
};

const keyPrefix = 'result/' + randomUUID() + '/'; // Optional: specify a folder in the bucket
const svgOutput = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"2000\" height=\"2000\" viewBox=\"0 0 2048 2048\"><g transform=\"translate(0 0)\"><rect width=\"511.822\" height=\"339.235\" fill=\"grey\" stroke=\"#010101\" class=\"bin\" transform=\"translate(0 0)\"/><g transform=\"translate(-488.634 -263.06775) rotate(0)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(609.6349754999999 -207.9275) rotate(90)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(-224.87802879999987 769.4467282) rotate(270)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(-127.54239130000002 -263.06775) rotate(0)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(958.8472801 602.30275) rotate(180)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(622.6456704999999 -488.634) rotate(90)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(-259.4438546999999 793.7189926000001) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(429.82529999999997 -530.9274309) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(-245.7518636999999 723.0807244000001) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(-453.65717199999995 -178.7385222) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(-447.86471689999996 -262.7193126) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(-404.91105689999995 -207.9321056) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(-111.5604607999999 789.0675004000001) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(591.0178635999999 -503.3082161) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(631.3892063 -461.17997349999996) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(634.525729 -389.1860336) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(1010.0230328 263.0107735999999) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"661.185,157.016 652.101,203.035 718.574,209.716 734.568,180.887 \"/></g><g transform=\"translate(-588.0215145999998 1378.1779502) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(614.2206732 -738.9303924999999) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-1028.5730787999998 -265.28599610000003) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(620.9075860999999 -752.5315254999998) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-1019.1449395999999 -277.42574210000004) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-1017.1381746999999 -323.69935090000007) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-1012.0190529999999 -292.26490340000004) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(640.6221730999999 -721.5789647999999) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1103.2224821999998 828.4869176999999) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1104.0898920999998 617.2931894) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(646.5938653999999 -735.4339018999999) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1108.2596202 631.8346081999999) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-991.7257884999999 -266.94489550000003) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-532.6377726999998 1217.8669462999999) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-987.2902691999999 -447.46015660000006) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1118.2832895 701.6537562999999) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1119.7393938999999 910.6451586) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(667.5780789999999 -1023.4279535) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-976.3413764 -265.28599610000003) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1140.9469703 919.1317789) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-950.5398769999999 -265.28599610000003) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(714.7503784999999 -835.3659132999999) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-475.7183097999998 1100.8061206) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(718.1843732 -850.1209213) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-463.41210099999984 1264.7612201) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-916.3293303999999 -472.5000112000001) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1198.1059722 798.9846891) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-444.79451419999987 1171.2419994999998) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-894.6021741999999 -381.98868170000003) rotate(0)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(-426.81525789999984 1255.5077643) rotate(270)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(1232.4058906 787.038065) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g><g transform=\"translate(774.9422763 -837.0065825999999) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"1057.909,602.939 1049.363,604.521 1043.723,597.907 1046.628,589.714 1055.174,588.14 1060.814,594.753\"/></g></g><g transform=\"translate(0 372.90000000000003)\"><rect width=\"511.822\" height=\"339.235\" fill=\"grey\" stroke=\"#010101\" class=\"bin\" transform=\"translate(0 0)\"/><g transform=\"translate(-488.634 -263.06775) rotate(0)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(599.9623226 586.07175) rotate(180)\"><path id=\"_x36_3-Science_x5F_Centre\" fill=\"green\" stroke=\"#ffffff\" stroke-width=\"0.7056\" stroke-linecap=\"round\" stroke-linejoin=\"bevel\" d=\"M 488.63399999999996 280.125 L 525.1724999999999 263.06775 C 525.1724999999999 263.06775 532.85925 286.53075 535.7782499999998 298.5495 C 539.0939999999999 312.20025000000004 541.6987499999999 326.067 543.5917499999999 340.02375 C 545.5065 354.1245 547.0484999999999 368.349 547.1624999999999 382.59675000000004 C 547.2734999999999 396.5295 545.7457499999998 410.43600000000004 544.3364999999999 424.28774999999996 C 543.0052499999999 437.37749999999994 541.4332499999998 450.46574999999996 539.0219999999998 463.3785 C 536.9167499999999 474.64725 534.5024999999998 485.8995 531.0494999999999 496.782 C 525.8362499999998 513.213 518.6159999999999 528.84 511.90049999999985 544.63425 C 508.02224999999976 553.7549999999999 499.6964999999998 571.71225 499.6964999999998 571.71225 L 488.7524999999998 586.07175 L 488.63399999999996 280.125 z\" fill-opacity=\"1\"/></g><g transform=\"translate(484.70259789999994 -560.5709839) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(484.7279325999999 -495.1612191) rotate(90)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"582.528,372.964 624.57,373.468 631.906,347.062 620.936,326.309 609.533,329.092 592.663,309.654 560.571,335.878 \"/></g><g transform=\"translate(845.8415414000001 345.4156825999999) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"661.185,157.016 652.101,203.035 718.574,209.716 734.568,180.887 \"/></g><g transform=\"translate(845.8597199000001 392.3495110999999) rotate(180)\"><polygon fill=\"green\" stroke=\"#010101\" stroke-miterlimit=\"10\" points=\"661.185,157.016 652.101,203.035 718.574,209.716 734.568,180.887 \"/></g></g></svg>";

const tmpPath = path.join('/tmp', '/tizada');
fs.mkdirSync(tmpPath, {recursive: true});
fs.writeFileSync(path.join(tmpPath, 'result.svg'), svgOutput, 'utf-8');

const filePath = path.join(tmpPath, 'result.svg');


uploadSVGToS3(filePath, bucketName, keyPrefix)
    .then(data => {
        console.log(`File uploaded successfully. ${data.Location}`);
    })
    .catch(err => {
        console.error(`Failed to upload file: ${err.message}`);
    });

